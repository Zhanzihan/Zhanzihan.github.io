[{"title":"逆元的求法与应用与应用","url":"/2018/11/05/逆元的求法与应用/","content":"\n# 逆元的求法与应用\n逆元主要在求m/n（mod p)时发挥作用\n逆元有好几种求法\n## 求法\n### 1.扩展欧几里得\n由 **am≡ 1 (mod p)**\n​\t得 **am-pk=1**\n​\t此时若有m与p互质就可以用扩展欧几里得求出逆元.\n\n```\nint exgcd(ll a,ll b,ll x,ll y){\n\tif(b==0){\n\t\tx=1;\n\t\ty=0;\n\t\treturn a;\n\t}\n\tll x1=y;\n\tll y1=x-a/b*y;\n\tx=x1,y=y1;\n\treturn exgcd(b,a%b,x,y);\n}\n```\n### 2.费马小定理\n当p为质数，a与p互质时，有a <sup>p-1</sup> ≡ 1 (mod p) \n所以a<sup>p-2</sup>≡a<sup>-1</sup>\n至于怎么证明=-=我也不会证明(可能会放到欧拉函数里讲)\n\n```\ninv[a]=quick_power(a,p-2);\n```\n### 3.线性求解1-n逆元（重点）\n**am ≡ 1 (mod  p)**   \n**r*r<sup>-1</sup>=1 (mod p)**\n我们设P=k*i+r;\n所以\n$\\lfloor \\frac{p}{i} \\rfloor$=k，p%i=r;\n在mod p的情况下有 \n**k*i+r ≡ 0 (mod p)**\n两边同时乘i<sup>-1</sup>,r<sup>-1</sup>有\n**-k*r<sup>-1</sup> ≡ i<sup>-1</sup>**\n带入k有\n**-p/i *(p%i)<sup>-1</sup> = i <sup>-1</sup> **\n所以i的逆元可以由p%i的逆元推出\n\n```\ninv[1]=1;\ninv[i]=(-p/i)*inv[i];\ninv[i]=(inv[i]%p+p)%p//(保证为正整数)\n```\n线性算法例题：[洛谷3811](https://www.luogu.org/problemnew/show/P3811)\n\n## 应用\n阶乘逆元\n\n```\ninv_fac[n]=quick_power(n,p-2);\nfor(int i=n-1;i>=1;i--)\n\tinv_fac[i]=inv_fac[i+1]*(i+1)%p;\n```\n这里为什么可以这么做手推一下就出来了\n相当于多除一个数之后再乘回去\n例题\n[triangle](http://noi.ac/contest/31/problem/65)\n```\n#include<cstdio>\n#include<cstdlib>\nusing namespace std;\nconst int N=100010;\nconst int MOD=1e9+9;\ntypedef long long ll;\nll fac[N+5],inv_fac[N+5];\nll quick_power(ll d,ll e)\n{\n\tll ans=1;\n\twhile(e)\n\t{\n\t\tif(e&1) ans=ans%MOD*d%MOD;\n\t\td=(d*d)%MOD;\n\t\te>>=1;\n\t}\n\tans%=MOD;\n\treturn ans;\t\n}\nint main()\n{\n\tint t;\n\tfac[1]=fac[0]=1;\n\tfor(int i=2;i<N;i++)fac[i]=fac[i-1]%MOD*i%MOD; \n\tinv_fac[N-1]=quick_power(fac[N-1],MOD-2);\n\tfor(int i=N-2;i>=1;i--)inv_fac[i]=inv_fac[i+1]%MOD*(i+1)%MOD;\n\tinv_fac[0]=1;\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tll a,b,n,m;\n\t\tscanf(\"%lld%lld%lld%lld\",&a,&b,&n,&m);\n\t\tll ans=fac[n-1]%MOD*inv_fac[m-1]%MOD*inv_fac[n-m]%MOD*quick_power(a,n-m)%MOD*quick_power(b,m-1)%MOD;\n\t\tprintf(\"%lld\\n\",ans%MOD);\n\t}\n}\n```\n\n\n\n","tags":["数学"]},{"title":"你好","url":"/2018/11/02/你好/","content":"终于搭建完成了=-="}]